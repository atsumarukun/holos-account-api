# 概要

アカウント機能を作成する.

# 対象範囲

## 達成基準

- アカウント作成用エンドポイントが作成されている
- アカウント更新用エンドポイントが作成されている
- アカウント削除用エンドポイントが作成されている

## 除外項目

- 認証機能の対応は行わない

# 利用方法

## エンドポイント

| パス | メソッド | 備考 |
| --- | --- | --- |
| /accounts | POST | アカウント作成 |
| /accounts | DELETE | アカウント削除 |
| /accounts/name | PATCH | アカウント名更新 |
| /accounts/password | PATCH | パスワード更新 |

# 詳細設計

## 要件

- アカウント名とパスワードでアカウントの作成を行う
- ログイン状態でアカウントの更新が行える
  - アカウント名の更新とパスワードの更新は別々に行う
  - トークンによる認証とパスワードを用いた認証両方が必要
- ログイン状態でアカウントの削除が行える
  - トークンによる認証とパスワードを用いた認証両方が必要

## 仕様

- アカウント名は3文字以上24文字以下かつローマ字, 数字, アンダースコアのみ
- アカウント名は重複できない
- パスワードは8文字以上72文字以下かつローマ字, 数字, 記号のみ
- パスワードと確認用パスワードを受け取り、一致しなければ作成は失敗する
- パスワードはハッシュ化された値が永続化される

## ドメインオブジェクト

| キー | 型 | 備考 |
| --- | --- | --- |
| id | uuid | |
| name | string | 3文字以上24文字以下<br />ローマ字, 数字, アンダースコアのみ |
| password | string | 8文字以上72文字以下<br />ローマ字, 数字, 記号のみ |

## テーブル

| カラム名 | 型 | キー | null許容 | 備考 |
| --- | --- | --- | :---: | --- |
| id | char(36) | PK | | ID |
| name | varchar(24) | UQ | | アカウント名 |
| password | varchar(60) | | | パスワード |
| created_at | datetime(6) | | | 作成日時 |
| updated_at | datetime(6) | | | 更新日時 |
| deleter_at | datetime(6) | | * | 削除日時 |

## テスト項目

| 項目 | 内容 |
| --- | --- |
| アカウントの初期化 | ドメインオブジェクトの初期化を確認 |
| アカウント名の有効値判定 | 3文字以上24文字以下<br />ローマ字, 数字, アンダースコアのみ |
| アカウント名の重複判定 | アカウント名重複時の判定 |
| パスワードの有効値判定 | 8文字以上72文字以下<br />ローマ字, 数字, 記号のみ |
| パスワード検証判定 | パスワード検証の判定 |
| 実行されるSQL | インフラ層で実行されるSQLの確認 |
| 実行される関数 | 実行される下位レイヤの関数を確認 |
| 戻り値 | 関数の戻り値を確認 |
| エラーハンドリング | エラー発生時のハンドリングを確認 |

# その他の手法

# 参考文献

# 変更履歴

| 変更日 | 変更者 | 変更内容 |
| --- | --- | --- |
| 2025/03/16 | @atsumarukun | 初版 |
| 2025/03/23 | @atsumarukun | 更新と削除時に認証を追加 |
| 2025/06/02 | @atsumarukun | アカウント名とパスワードの更新をPATCHに変更 |
